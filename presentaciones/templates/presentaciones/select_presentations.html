{% extends 'presentaciones/base.html' %}

{% block content %}
<div class="container mt-5">
    <h2>Importar Presentaciones de Google Slides</h2>
    <p class="text-muted">Selecciona las presentaciones que deseas importar</p>

    <form method="post" action="{% url 'import_selected_presentations' %}">
        {% csrf_token %}
        
        {% if presentations %}
            <div class="row">
                {% for presentation in presentations %}
                <div class="col-md-4 mb-4">
                    <div class="card">
                        {% if presentation.thumbnailLink %}
                        <img src="{{ presentation.thumbnailLink }}" class="card-img-top" alt="{{ presentation.name }}">
                        {% else %}
                        <div class="card-img-top bg-light d-flex align-items-center justify-content-center" style="height: 200px;">
                            <i class="fas fa-file-powerpoint fa-3x text-muted"></i>
                        </div>
                        {% endif %}
                        
                        <div class="card-body">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" 
                                       name="presentations" 
                                       value="{{ presentation.id }}" 
                                       id="pres_{{ presentation.id }}">
                                <label class="form-check-label" for="pres_{{ presentation.id }}">
                                    <h6 class="card-title">{{ presentation.name }}</h6>
                                </label>
                            </div>
                            <small class="text-muted">
                                Modificado: {{ presentation.modifiedTime|date:"d/m/Y" }}
                            </small>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="mt-4">
                <button type="button" class="btn btn-secondary" onclick="toggleAll()">
                    Seleccionar todas
                </button>
                <button type="submit" class="btn btn-primary">
                    Importar seleccionadas
                </button>
                <a href="{% url 'home' %}" class="btn btn-outline-secondary">
                    Cancelar
                </a>
            </div>
        {% else %}
            <div class="alert alert-info">
                No se encontraron presentaciones en tu cuenta de Google.
            </div>
            <a href="{% url 'home' %}" class="btn btn-primary">Volver al inicio</a>
        {% endif %}
    </form>
</div>

<script>
function toggleAll() {
    const checkboxes = document.querySelectorAll('input[name="presentations"]');
    const allChecked = Array.from(checkboxes).every(cb => cb.checked);
    checkboxes.forEach(cb => cb.checked = !allChecked);
}
</script>
{% endblock %}